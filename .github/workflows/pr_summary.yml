name: "PR技术文档自动生成"
on:
  pull_request:
    types: [opened, synchronize]
jobs:
  rp-documentation:
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - name: "初始化代码分析"
        uses: iflow-ai/iflow-cli-action@v2.0.0
        with:
          prompt: "/init"
          api_key: ${{ secrets.IFLOW_API_KEY }}
          timeout: "600"
          working_directory: "."
      - name: "文档生成"
        uses: iflow-ai/iflow-cli-action@v2.0.0
        with:
          prompt: "Generate technical documentation based on the codebase analysis"
          api_key: ${{ secrets.IFLOW_API_KEY }}
        id: docs
      - name: "显示结果"
        run: |
          echo "生成的文档"
          echo "${{ steps.docs.outputs.result }}"
